!function(t){var e={};function n(i){if(e[i])return e[i].exports;var a=e[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(i,a,function(e){return t[e]}.bind(null,a));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){n(1),t.exports=n(3)},function(t,e,n){(function(i){var a,c,o;o=void 0!==i?i:this.window||this.global,a=function(t){"use strict";var e,n,i,a,c=1,o=(new DOMParser,!1);const r={punchListItems:"punch-items",punchListItem:"punch-item-",punchListItemText:"punch-item-text-",punchListComments:"punch-comments-",punchListComment:"punch-comment-",punchListCommentText:"punch-comment-text-",punchListProjects:"punch-projects",punchListWorking:"punch-working"},s={punchListLoading:'<div class="punchlist-loader"></div>',punchlistProjectTemplate:({id:t,name:e})=>`<option value="${t}">${e}</option>`,punchListContainerTemplate:({title:t,projects:e})=>`<div id="${r.punchListWorking}" class="punchlist-working hidden"></div><div class="punchlist-title">\n    <h1><i class="fa fa-check"></i>${t}</h1>\n    </div>\n    <div class="punchlist-projects"> Project: \n    <select id="${r.punchListProjects}">\n      ${e?e.map(s.punchlistProjectTemplate).join(""):'<option value="-1">No Projects</option>'}\n    </select>\n    </div>        \n    <div class="punchlist-items-container">\n    <div id="${r.punchListItems}" class="punchlist-items"></div>\n    <div class="punchlist-item-action-add" data-action="punchlist-item-action-add">\n      <i class="fa fa-plus"></i>\n      Add an Item\n    </div>        \n    </div>`,punchListCommentTagsTemplate:t=>`<b>${t.name}</b>: ${t.value}`,punchListCommentTemplate:t=>`<div class="punchlist-comment" id="${r.punchListComment+t.id}" data-id="${t.id}">\n    <div class="punchlist-comment-text" id="${r.punchListCommentText+t.id}">${t.comment}</div>\n    <div class="punchlist-comment-tag">${t.tags?t.tags.map(s.punchListCommentTagsTemplate).join(" - "):""}${t.deletable?'<i class="fa fa-times-circle punchlist-item-comment-action-remove" data-action="punchlist-item-comment-action-remove" data-id="'+t.id+'"></i>':""}</div>\n    </div>`,punchListItemTagsTemplate:t=>`<div class="punchlist-item-tag"><b>${t.name}</b>: ${t.value}</div>`,punchListItemTemplate:t=>`<div class="punchlist-item-container" id="${r.punchListItem+t.id}" data-id="${t.id}">\n    <div class="punchlist-item">\n    <div class="punchlist-item-label">\n    <input type="checkbox" id="check-punch-item-${t.id}" ${t.punched?"checked":""} data-id="${t.id}" data-action="punchlist-item-action-checked"/>\n    <label for="check-punch-item-${t.id}" class="punchlist-item-label-text">\n    <i class="fa fa-check"></i> \n    <span class="punchlist-item-label-text-line">\n    <span class="punchlist-item-label-text-data" id="${r.punchListItemText+t.id}">${t.task}</span>\n    </span>\n    </label>\n    </div>\n    <div class="punchlist-item-action" title="comments" data-action="punchlist-item-action-comment" data-id="${t.id}">\n    <i class="fa fa-comment punchlist-item-action-comment" data-action="punchlist-item-action-comment" data-id="${t.id}"></i>\n    </div>\n    <div class="punchlist-item-action" title="remove" data-action="punchlist-item-action-remove" data-id="${t.id}">\n    <i class="fa fa-times-circle punchlist-item-action-remove" data-action="punchlist-item-action-remove" data-id="${t.id}"></i>\n    </div>\n    </div>\n    <div class="punchlist-item-tags">\n    ${t.tags?t.tags.map(s.punchListItemTagsTemplate).join(""):""}\n    </div>\n    <div class="punch-list-comments hidden" id="${r.punchListComments+t.id}">\n    ${t.comments?t.comments.map(s.punchListCommentTemplate).join(""):""}\n    </div>\n    <div class="punchlist-item-comment-action-add" data-id="${t.id}" data-action="punchlist-item-comment-action-add">\n    <i class="fa fa-plus"></i>\n    Add Comment\n    </div>\n    </div>`};var l,u=window.punchList={},m=!!document.querySelector&&!!t.addEventListener,d={title:"Punch List",width:null,projectAPICall:null,itemAPICall:null,commentAPICall:null,projects:null},p=function(){o=!0,a.classList.remove("hidden")},h=function(){o=!1,a.classList.add("hidden")},v=function(){if(l.projectAPICall){var t=n.querySelector("#"+r.punchListProjects);i.innerHTML=s.punchListLoading,e=t.value,p(),Utils.apiCall("GET",l.projectAPICall+e,null,function(e){var n=f(e.items);u.drawItems(n),t.disabled=!1,h()},function(e){console.error(e),u.drawItems([]),t.disabled=!1,h()},l.apiToken)}},f=function(t){var e=[];for(var n of t)e.push(L(n));return e},L=function(t){var e={};e.id=t.id,e.task=t.title,e.tags=[{name:"User",value:t.user.name},{name:"Company",value:t.user.company},{name:"Date",value:new Date(t.created_at).toLocaleString()}],e.punched=t.punched;var n=[];if(t.comments)for(var i of t.comments)n.push(g(i));return e.comments=n,e},g=function(t){var e={};return e.id=t.id,e.comment=t.text,t.user.id==c&&(e.deletable=!0),e.tags=[{name:"User",value:t.user.name},{name:"Company",value:t.user.company},{name:"Date",value:new Date(t.created_at).toLocaleString()}],e},y=function(t){var e=t.offsetHeight,n=t.animate([{height:e+"px"},{height:"0px"}],{duration:300});n.onfinish=function(e){t.remove()}},b=function(t){var e=t.getAttribute("data-id");l.itemAPICall?(p(),Utils.apiCall("DELETE",l.itemAPICall+e,null,function(t){h();var n=i.querySelector("#"+r.punchListItem+e);y(n)},function(t){console.error(t),h()},l.apiToken)):y(punchItem)},w=function(t){var e=document.createElement("input");return e.type="text",e.id=t,e.style.width="100%",e},T=function(t){var n=i.querySelector("#"+r.punchListItem+"new"),a=i,o=t.value;if(o.length>0)if(l.itemAPICall){p();var u={title:o,user_id:c,project_id:e,punched:!1};Utils.apiCall("POST",l.itemAPICall,u,function(t){var e=L(t),i=Utils.map([e],s.punchListItemTemplate).join("");n.remove(),a.innerHTML=a.innerHTML+i,h()},function(t){n.remove(),console.error(t),h()},l.apiToken)}else{var t={id:new Date.getTime,task:o,comments:[],tags:[],data:[]},m=Utils.map(t,s.punchListItemTemplate).join("");b.remove(),i.innerHTML=punchlistItems.innerHTML+m}else n.remove()},j=function(t){var e=t.getAttribute("data-id"),n=i.querySelector("#"+r.punchListComment+"new"),a=t.value;if(a.length>0)if(l.commentAPICall){p();var o={text:a,user_id:c,item_id:e};Utils.apiCall("POST",l.commentAPICall,o,function(t){var a=g(t),c=i.querySelector("#"+r.punchListComments+e),o=Utils.map([a],s.punchListCommentTemplate).join("");n.remove(),c.innerHTML=o+c.innerHTML,h()},function(t){n.remove(),console.error(t),h()},l.apiToken)}else t.parentNode.innerHTML=a;else n.remove()},C=function(t){if(!o){var e=t.target.getAttribute("data-action");switch(e){case"punchlist-item-action-checked":!function(t){var e=t.getAttribute("data-id");if(l.itemAPICall){p();var n={punched:t.checked};Utils.apiCall("PUT",l.itemAPICall+e,n,function(e){var n=L(e);t.checked=n.punched,h()},function(e){console.error(e),t.checked=!t.checked,h()},l.apiToken)}}(t.target);break;case"punchlist-item-action-comment":n=t.target,a=n.getAttribute("data-id"),i.querySelector("#"+r.punchListComments+a).classList.toggle("hidden");break;case"punchlist-item-action-remove":b(t.target);break;case"punchlist-item-action-add":!function(){var t=[{id:"new",task:"",comments:[],tags:[],data:[]}],e=Utils.map(t,s.punchListItemTemplate).join("");i.innerHTML=i.innerHTML+e;var n=i.querySelector("#"+r.punchListItem+"new").querySelector("#"+r.punchListItemText+"new"),a=w("punch-item-text-input");a.addEventListener("blur",k,!1),n.append(a),a.focus()}();break;case"punchlist-item-comment-action-add":!function(t){var e=t.getAttribute("data-id"),n=i.querySelector("#"+r.punchListComments+e),a={id:"new",comment:"",tags:[]},c=Utils.map([a],s.punchListCommentTemplate).join("");n.innerHTML=c+n.innerHTML;var o=w("punch-comment-input-text");o.setAttribute("data-id",e),n.querySelector("#"+r.punchListCommentText+"new").append(o),o.addEventListener("blur",k,!1),o.focus()}(t.target);break;case"punchlist-item-comment-action-remove":!function(t){var e=t.getAttribute("data-id"),n=i.querySelector("#"+r.punchListComment+e);l.commentAPICall?(p(),Utils.apiCall("DELETE",l.commentAPICall+e,null,function(t){n.remove(),h()},function(t){console.error(t),h()},l.apiToken)):n.remove()}(t.target)}}var n,a},k=function(t){if(!o){var e=t.target.getAttribute("id");switch(e){case"punch-item-text-input":T(t.target);break;case"punch-comment-input-text":j(t.target)}}},I=function(t){if(!o){var e=t.target.getAttribute("id");switch(e){case"punch-projects":v()}}},x=function(t){var e=t.which||t.keyCode;if(13===e){var n=t.target.getAttribute("id");switch(n){case"punch-item-text-input":t.target.removeEventListener("blur",k,!1),T(t.target);break;case"punch-comment-input-text":t.target.removeEventListener("blur",k,!1),j(t.target)}}};return u.destroy=function(){l&&(n.removeEventListener("click",C,!1),n.removeEventListener("keypress",x,!1),n.removeEventListener("change",I,!0),l=null)},u.init=function(t){var e=new URLSearchParams(location.search);if(e.has("user_id")&&(c=e.get("user_id")),!m)return;u.destroy(),l=Utils.extend(d,t);let o=document.querySelector(l.container);o?(function(t){t.classList.add("punchlist-container");var e=[{title:l.title,projects:l.projects}].map(s.punchListContainerTemplate).join("");l.width&&(t.style.width=l.width+"px"),t.innerHTML=e}(n=o),i=n.querySelector("#"+r.punchListItems),n.addEventListener("click",C,!1),n.addEventListener("keypress",x,!1),n.addEventListener("change",I,!0),a=n.querySelector("#"+r.punchListWorking),v()):(console.error('[PunchList][init] Main container not found. Selector: "'+l.container+'"'),u.destroy())},u.drawItems=function(t){if(t.length>0){var e=t.map(s.punchListItemTemplate).join("");i.innerHTML=e}else i.innerHTML="No Items Found"},u}(o),void 0===(c="function"==typeof a?a.call(e,n,e,t):a)||(t.exports=c)}).call(this,n(2))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){!function(){var t=window.DomReady={},e=navigator.userAgent.toLowerCase(),n={version:(e.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[])[1],safari:/webkit/.test(e),opera:/opera/.test(e),msie:/msie/.test(e)&&!/opera/.test(e),mozilla:/mozilla/.test(e)&&!/(compatible|webkit)/.test(e)},i=!1,a=!1,c=[];function o(){if(!a&&(a=!0,c)){for(var t=0;t<c.length;t++)c[t].call(window,[]);c=[]}}function r(){if(!i){var t,e,c;if(i=!0,document.addEventListener&&!n.opera&&document.addEventListener("DOMContentLoaded",o,!1),n.msie&&window==top&&function(){if(!a){try{document.documentElement.doScroll("left")}catch(t){return void setTimeout(arguments.callee,0)}o()}}(),n.opera&&document.addEventListener("DOMContentLoaded",function(){if(!a){for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].disabled)return void setTimeout(arguments.callee,0);o()}},!1),n.safari)!function(){if(!a)if("loaded"==document.readyState||"complete"==document.readyState){if(void 0===t){for(var e=document.getElementsByTagName("link"),n=0;n<e.length;n++)"stylesheet"==e[n].getAttribute("rel")&&t++;var i=document.getElementsByTagName("style");t+=i.length}document.styleSheets.length==t?o():setTimeout(arguments.callee,0)}else setTimeout(arguments.callee,0)}();e=o,c=window.onload,"function"!=typeof window.onload?window.onload=e:window.onload=function(){c&&c(),e()}}}t.ready=function(t,e){r(),a?t.call(window,[]):c.push(function(){return t.call(window,[])})},r()}();window.Utils={map:function(t,e){var n;if(Array.isArray(t))n=t.map(e);else if("object"==typeof t&&t)for(var i in n=[],t)n.push(e(t[i],i,t));return n},mapWithIndex:function(t,e,n){var i;return"object"==typeof e&&e&&(i=[]).push(n(e,t,e)),i},extend:function(){var t={},e=!1,n=0,i=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(e=arguments[0],n++);for(var a=function(n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e&&"[object Object]"===Object.prototype.toString.call(n[i])?t[i]=extend(!0,t[i],n[i]):t[i]=n[i])};n<i;n++)a(arguments[n]);return t},apiCall:function(t,e,n,i,a,c){const o=new Headers;var r,s;o.append("Content-Type","application/json"),o.append("Authorization","Bearer "+c),o.append("Accept","application/json, text-plain, */*"),o.append("X-Requested-With","XMLHttpRequest");var l={method:t,mode:"cors",cache:"no-cache",credentials:"same-origin",headers:o,redirect:"follow",referrer:"no-referrer"};return"GET"!=t&&n&&(l.body=JSON.stringify(n)),fetch(e,l).then(t=>(r=t.status,s=t.ok,t.json())).then(t=>{if(!s){var e=new Error("Punch List Error");throw e.code=r,e.json=t,e}i(t)}).catch(t=>{if(!t.json)throw t;information=t.json,a(information)})}}}]);