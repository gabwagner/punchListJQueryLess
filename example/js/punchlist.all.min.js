!function(t){var e={};function n(i){if(e[i])return e[i].exports;var a=e[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(i,a,function(e){return t[e]}.bind(null,a));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){n(1),t.exports=n(3)},function(t,e,n){(function(i){var a,c,o;o=void 0!==i?i:this.window||this.global,a=function(t){"use strict";new DOMParser;var e,n,i,a,c=!1;const o={punchListItems:"punch-items",punchListItem:"punch-item-",punchListItemText:"punch-item-text-",punchListComments:"punch-comments-",punchListComment:"punch-comment-",punchListCommentText:"punch-comment-text-",punchListProjects:"punch-projects",punchListWorking:"punch-working"},r={punchListLoading:'<div class="punchlist-loader"></div>',punchlistProjectTemplate:({id:t,name:e})=>`<option value="${t}">${e}</option>`,punchListContainerTemplate:({title:t,projects:e})=>`<div id="${o.punchListWorking}" class="punchlist-working hidden"></div><div class="punchlist-title">\n    <h1><i class="fa fa-check"></i>${t}</h1>\n    </div>\n    <div class="punchlist-projects"> Project: \n    <select id="${o.punchListProjects}">\n      ${e?e.map(r.punchlistProjectTemplate).join(""):'<option value="-1">No Projects</option>'}\n    </select>\n    </div>        \n    <div class="punchlist-items-container">\n    <div id="${o.punchListItems}" class="punchlist-items"></div>\n    <div class="punchlist-item-action-add" data-action="punchlist-item-action-add">\n      <i class="fa fa-plus"></i>\n      Add an Item\n    </div>        \n    </div>`,punchListCommentTagsTemplate:t=>`<b>${t.name}</b>: ${t.value}`,punchListCommentTemplate:t=>`<div class="punchlist-comment" id="${o.punchListComment+t.id}" data-id="${t.id}">\n    <div class="punchlist-comment-text" id="${o.punchListCommentText+t.id}">${t.comment}</div>\n    <div class="punchlist-comment-tag">${t.tags?t.tags.map(r.punchListCommentTagsTemplate).join(" - "):""}${t.deletable?'<i class="fa fa-times-circle punchlist-item-comment-action-remove" data-action="punchlist-item-comment-action-remove" data-id="'+t.id+'"></i>':""}</div>\n    </div>`,punchListItemTagsTemplate:t=>`<div class="punchlist-item-tag"><b>${t.name}</b>: ${t.value}</div>`,punchListItemTemplate:t=>`<div class="punchlist-item-container" id="${o.punchListItem+t.id}" data-id="${t.id}">\n    <div class="punchlist-item">\n    <div class="punchlist-item-label">\n    <input type="checkbox" id="check-punch-item-${t.id}" ${t.punched?"checked":""} data-id="${t.id}" data-action="punchlist-item-action-checked"/>\n    <label for="check-punch-item-${t.id}" class="punchlist-item-label-text">\n    <i class="fa fa-check"></i> \n    <span class="punchlist-item-label-text-line">\n    <span class="punchlist-item-label-text-data" id="${o.punchListItemText+t.id}">${t.task}</span>\n    </span>\n    </label>\n    </div>\n    <div class="punchlist-item-action" title="comments" data-action="punchlist-item-action-comment" data-id="${t.id}">\n    <i class="fa fa-comment punchlist-item-action-comment" data-action="punchlist-item-action-comment" data-id="${t.id}"></i>\n    </div>\n    <div class="punchlist-item-action" title="remove" data-action="punchlist-item-action-remove" data-id="${t.id}">\n    <i class="fa fa-times-circle punchlist-item-action-remove" data-action="punchlist-item-action-remove" data-id="${t.id}"></i>\n    </div>\n    </div>\n    <div class="punchlist-item-tags">\n    ${t.tags?t.tags.map(r.punchListItemTagsTemplate).join(""):""}\n    </div>\n    <div class="punch-list-comments hidden" id="${o.punchListComments+t.id}">\n    ${t.comments?t.comments.map(r.punchListCommentTemplate).join(""):""}\n    </div>\n    <div class="punchlist-item-comment-action-add" data-id="${t.id}" data-action="punchlist-item-comment-action-add">\n    <i class="fa fa-plus"></i>\n    Add Comment\n    </div>\n    </div>`};var s,l=window.punchList={},u=!!document.querySelector&&!!t.addEventListener,m={title:"Punch List",width:null,projectAPICall:null,itemAPICall:null,commentAPICall:null,projects:null,userId:1},d=function(){c=!0,a.classList.remove("hidden")},p=function(){c=!1,a.classList.add("hidden")},h=function(){if(s.projectAPICall){var t=n.querySelector("#"+o.punchListProjects);i.innerHTML=r.punchListLoading,e=t.value,d(),Utils.apiCall("GET",s.projectAPICall+"/"+e,null,function(e){var n=v(e.items);l.drawItems(n),t.disabled=!1,p()},function(e){console.error(e),l.drawItems([]),t.disabled=!1,p()},s.apiToken)}},v=function(t){var e=[];for(var n of t)e.push(f(n));return e},f=function(t){var e={};e.id=t.id,e.task=t.title,e.tags=[{name:"User",value:t.user.name},{name:"Company",value:t.user.company},{name:"Date",value:new Date(t.created_at).toLocaleString()}],e.punched=t.punched;var n=[];if(t.comments)for(var i of t.comments)n.push(L(i));return e.comments=n,e},L=function(t){var e={};return e.id=t.id,e.comment=t.text,t.user.id==s.userId&&(e.deletable=!0),e.tags=[{name:"User",value:t.user.name},{name:"Company",value:t.user.company},{name:"Date",value:new Date(t.created_at).toLocaleString()}],e},g=function(t){var e=t.offsetHeight,n=t.animate([{height:e+"px"},{height:"0px"}],{duration:300});n.onfinish=function(e){t.remove()}},y=function(t){var e=t.getAttribute("data-id");s.itemAPICall?(d(),Utils.apiCall("DELETE",s.itemAPICall+"/"+e,null,function(t){p();var n=i.querySelector("#"+o.punchListItem+e);g(n)},function(t){console.error(t),p()},s.apiToken)):g(punchItem)},b=function(t){var e=document.createElement("input");return e.type="text",e.id=t,e.style.width="100%",e},w=function(t){var n=i.querySelector("#"+o.punchListItem+"new"),a=i,c=t.value;if(c.length>0)if(s.itemAPICall){d();var l={title:c,user_id:s.userId,project_id:e,punched:!1};Utils.apiCall("POST",s.itemAPICall,l,function(t){var e=f(t),i=Utils.map([e],r.punchListItemTemplate).join("");n.remove(),a.innerHTML=a.innerHTML+i,p()},function(t){n.remove(),console.error(t),p()},s.apiToken)}else{var t={id:new Date.getTime,task:c,comments:[],tags:[],data:[]},u=Utils.map(t,r.punchListItemTemplate).join("");y.remove(),i.innerHTML=punchlistItems.innerHTML+u}else n.remove()},T=function(t){var e=t.getAttribute("data-id"),n=i.querySelector("#"+o.punchListComment+"new"),a=t.value;if(a.length>0)if(s.commentAPICall){d();var c={text:a,user_id:s.userId,item_id:e};Utils.apiCall("POST",s.commentAPICall,c,function(t){var a=L(t),c=i.querySelector("#"+o.punchListComments+e),s=Utils.map([a],r.punchListCommentTemplate).join("");n.remove(),c.innerHTML=s+c.innerHTML,p()},function(t){n.remove(),console.error(t),p()},s.apiToken)}else t.parentNode.innerHTML=a;else n.remove()},j=function(t){if(!c){var e=t.target.getAttribute("data-action");switch(e){case"punchlist-item-action-checked":!function(t){var e=t.getAttribute("data-id");if(s.itemAPICall){d();var n={punched:t.checked};Utils.apiCall("PUT",s.itemAPICall+"/"+e,n,function(e){var n=f(e);t.checked=n.punched,p()},function(e){console.error(e),t.checked=!t.checked,p()},s.apiToken)}}(t.target);break;case"punchlist-item-action-comment":n=t.target,a=n.getAttribute("data-id"),i.querySelector("#"+o.punchListComments+a).classList.toggle("hidden");break;case"punchlist-item-action-remove":y(t.target);break;case"punchlist-item-action-add":!function(){var t=[{id:"new",task:"",comments:[],tags:[],data:[]}],e=Utils.map(t,r.punchListItemTemplate).join("");i.innerHTML=i.innerHTML+e;var n=i.querySelector("#"+o.punchListItem+"new").querySelector("#"+o.punchListItemText+"new"),a=b("punch-item-text-input");a.addEventListener("blur",C,!1),n.append(a),a.focus()}();break;case"punchlist-item-comment-action-add":!function(t){var e=t.getAttribute("data-id"),n=i.querySelector("#"+o.punchListComments+e),a={id:"new",comment:"",tags:[]},c=Utils.map([a],r.punchListCommentTemplate).join("");n.innerHTML=c+n.innerHTML;var s=b("punch-comment-input-text");s.setAttribute("data-id",e),n.querySelector("#"+o.punchListCommentText+"new").append(s),s.addEventListener("blur",C,!1),s.focus()}(t.target);break;case"punchlist-item-comment-action-remove":!function(t){var e=t.getAttribute("data-id"),n=i.querySelector("#"+o.punchListComment+e);s.commentAPICall?(d(),Utils.apiCall("DELETE",s.commentAPICall+"/"+e,null,function(t){n.remove(),p()},function(t){console.error(t),p()},s.apiToken)):n.remove()}(t.target)}}var n,a},C=function(t){if(!c){var e=t.target.getAttribute("id");switch(e){case"punch-item-text-input":w(t.target);break;case"punch-comment-input-text":T(t.target)}}},I=function(t){if(!c){var e=t.target.getAttribute("id");switch(e){case"punch-projects":h()}}},k=function(t){var e=t.which||t.keyCode;if(13===e){var n=t.target.getAttribute("id");switch(n){case"punch-item-text-input":t.target.removeEventListener("blur",C,!1),w(t.target);break;case"punch-comment-input-text":t.target.removeEventListener("blur",C,!1),T(t.target)}}};return l.destroy=function(){s&&(n.removeEventListener("click",j,!1),n.removeEventListener("keypress",k,!1),n.removeEventListener("change",I,!0),s=null)},l.init=function(t){if(!u)return;l.destroy(),s=Utils.extend(m,t);let e=document.querySelector(s.container);e?(function(t){t.classList.add("punchlist-container");var e=[{title:s.title,projects:s.projects}].map(r.punchListContainerTemplate).join("");s.width&&(t.style.width=s.width+"px"),t.innerHTML=e}(n=e),i=n.querySelector("#"+o.punchListItems),n.addEventListener("click",j,!1),n.addEventListener("keypress",k,!1),n.addEventListener("change",I,!0),a=n.querySelector("#"+o.punchListWorking),h()):(console.error('[PunchList][init] Main container not found. Selector: "'+s.container+'"'),l.destroy())},l.drawItems=function(t){if(t.length>0){var e=t.map(r.punchListItemTemplate).join("");i.innerHTML=e}else i.innerHTML="No Items Found"},l}(o),void 0===(c="function"==typeof a?a.call(e,n,e,t):a)||(t.exports=c)}).call(this,n(2))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){!function(){var t=window.DomReady={},e=navigator.userAgent.toLowerCase(),n={version:(e.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[])[1],safari:/webkit/.test(e),opera:/opera/.test(e),msie:/msie/.test(e)&&!/opera/.test(e),mozilla:/mozilla/.test(e)&&!/(compatible|webkit)/.test(e)},i=!1,a=!1,c=[];function o(){if(!a&&(a=!0,c)){for(var t=0;t<c.length;t++)c[t].call(window,[]);c=[]}}function r(){if(!i){var t,e,c;if(i=!0,document.addEventListener&&!n.opera&&document.addEventListener("DOMContentLoaded",o,!1),n.msie&&window==top&&function(){if(!a){try{document.documentElement.doScroll("left")}catch(t){return void setTimeout(arguments.callee,0)}o()}}(),n.opera&&document.addEventListener("DOMContentLoaded",function(){if(!a){for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].disabled)return void setTimeout(arguments.callee,0);o()}},!1),n.safari)!function(){if(!a)if("loaded"==document.readyState||"complete"==document.readyState){if(void 0===t){for(var e=document.getElementsByTagName("link"),n=0;n<e.length;n++)"stylesheet"==e[n].getAttribute("rel")&&t++;var i=document.getElementsByTagName("style");t+=i.length}document.styleSheets.length==t?o():setTimeout(arguments.callee,0)}else setTimeout(arguments.callee,0)}();e=o,c=window.onload,"function"!=typeof window.onload?window.onload=e:window.onload=function(){c&&c(),e()}}}t.ready=function(t,e){r(),a?t.call(window,[]):c.push(function(){return t.call(window,[])})},r()}();window.Utils={map:function(t,e){var n;if(Array.isArray(t))n=t.map(e);else if("object"==typeof t&&t)for(var i in n=[],t)n.push(e(t[i],i,t));return n},mapWithIndex:function(t,e,n){var i;return"object"==typeof e&&e&&(i=[]).push(n(e,t,e)),i},extend:function(){var t={},e=!1,n=0,i=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(e=arguments[0],n++);for(var a=function(n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e&&"[object Object]"===Object.prototype.toString.call(n[i])?t[i]=extend(!0,t[i],n[i]):t[i]=n[i])};n<i;n++)a(arguments[n]);return t},apiCall:function(t,e,n,i,a,c){const o=new Headers;var r,s;o.append("Content-Type","application/json"),o.append("Authorization","Bearer "+c),o.append("Accept","application/json, text-plain, */*"),o.append("X-Requested-With","XMLHttpRequest");var l={method:t,mode:"cors",cache:"no-cache",credentials:"same-origin",headers:o,redirect:"follow",referrer:"no-referrer"};return"GET"!=t&&n&&(l.body=JSON.stringify(n)),fetch(e,l).then(t=>(r=t.status,s=t.ok,t.json())).then(t=>{if(!s){var e=new Error("Punch List Error");throw e.code=r,e.json=t,e}i(t)}).catch(t=>{if(!t.json)throw t;information=t.json,a(information)})}}}]);